<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gold Trading Bot - Live Dashboard</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body class="bg-dark">
    
    <!-- Header -->
    <nav class="navbar navbar-dark bg-dark border-bottom border-secondary">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">
                <i class="bi bi-currency-exchange"></i> Gold Trading Bot - Live Dashboard
            </span>
            <div class="d-flex align-items-center">
                <span class="badge bg-success me-2" id="connection-status">
                    <i class="bi bi-wifi"></i> Connected
                </span>
                <span class="text-light small" id="current-time">--:--:--</span>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-3">
        
        <!-- Bot Status Banner -->
        <div class="row mb-3">
            <div class="col-12">
                <div class="alert alert-info d-flex align-items-center" role="alert" id="bot-status-banner">
                    <i class="bi bi-info-circle-fill me-2"></i>
                    <strong id="bot-status-text">Initializing...</strong>
                </div>
            </div>
        </div>

        <!-- Row 1: Account Info + Current Position -->
        <div class="row mb-3">
            
            <!-- Account Information -->
            <div class="col-lg-6 mb-3">
                <div class="card bg-dark text-light border-secondary">
                    <div class="card-header bg-secondary">
                        <i class="bi bi-wallet2"></i> Account Information
                    </div>
                    <div class="card-body">
                        <div class="row g-2">
                            <div class="col-6">
                                <div class="metric-box">
                                    <small class="label-text">Balance</small>
                                    <h4 class="text-success" id="account-balance">$0.00</h4>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="metric-box">
                                    <small class="label-text">Equity</small>
                                    <h4 class="text-info" id="account-equity">$0.00</h4>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="metric-box">
                                    <small class="label-text">Free Margin</small>
                                    <h4 class="text-light" id="account-free-margin">$0.00</h4>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="metric-box">
                                    <small class="label-text">Current Profit</small>
                                    <h4 id="account-profit" class="text-warning">$0.00</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Current Position -->
            <div class="col-lg-6 mb-3">
                <div class="card bg-dark text-light border-secondary">
                    <div class="card-header bg-secondary">
                        <i class="bi bi-graph-up-arrow"></i> Current Position
                    </div>
                    <div class="card-body" id="position-container">
                        <div class="text-center py-4" id="no-position-msg" style="color: #aaa;">
                            <i class="bi bi-inbox" style="font-size: 2rem;"></i>
                            <p class="mt-2">No open position</p>
                        </div>
                        <div id="position-details" style="display: none;">
                            <div class="row g-2">
                                <div class="col-6">
                                    <small class="label-text">Type</small>
                                    <h5 id="position-type" class="text-light">--</h5>
                                </div>
                                <div class="col-6">
                                    <small class="label-text">Ticket</small>
                                    <h5 id="position-ticket" class="text-light">--</h5>
                                </div>
                                <div class="col-6">
                                    <small class="label-text">Entry Price</small>
                                    <h5 id="position-entry" class="text-light">--</h5>
                                </div>
                                <div class="col-6">
                                    <small class="label-text">Current Price</small>
                                    <h5 id="position-current" class="text-light">--</h5>
                                </div>
                                <div class="col-6">
                                    <small class="label-text">Stop Loss</small>
                                    <h5 id="position-sl" class="text-danger">--</h5>
                                </div>
                                <div class="col-6">
                                    <small class="label-text">Take Profit</small>
                                    <h5 id="position-tp" class="text-success">--</h5>
                                </div>
                                <div class="col-6">
                                    <small class="label-text">Profit/Loss</small>
                                    <h4 id="position-profit" class="text-warning">$0.00</h4>
                                </div>
                                <div class="col-6">
                                    <small class="label-text">Duration</small>
                                    <h5 id="position-duration" class="text-light">0:00:00</h5>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Row 2: SAR Indicator + Signal -->
        <div class="row mb-3">
            
            <!-- Parabolic SAR Indicator -->
            <div class="col-lg-6 mb-3">
                <div class="card bg-dark text-light border-secondary">
                    <div class="card-header bg-secondary">
                        <i class="bi bi-activity"></i> Parabolic SAR Indicator
                    </div>
                    <div class="card-body">
                        <div class="row g-2">
                            <div class="col-4">
                                <div class="metric-box text-center">
                                    <small class="label-text">SAR Value</small>
                                    <h4 class="text-warning" id="sar-value">--</h4>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="metric-box text-center">
                                    <small class="label-text">Trend</small>
                                    <h4 id="sar-trend" class="text-light">--</h4>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="metric-box text-center">
                                    <small class="label-text">Distance</small>
                                    <h5 class="text-info" id="sar-distance">--</h5>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Current Signal -->
            <div class="col-lg-6 mb-3">
                <div class="card bg-dark text-light border-secondary">
                    <div class="card-header bg-secondary">
                        <i class="bi bi-bullseye"></i> Current Signal
                    </div>
                    <div class="card-body text-center">
                        <div class="signal-display py-3">
                            <h1 id="signal-type" class="display-4 text-light">HOLD</h1>
                            <p id="signal-reason" class="text-secondary" style="color: #aaa !important;">Waiting for signal...</p>
                            <small id="signal-time" class="text-secondary" style="color: #999 !important;">--</small>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Row 3: Price Chart -->
        <div class="row mb-3">
            <div class="col-12">
                <div class="card bg-dark text-light border-secondary">
                    <div class="card-header bg-secondary">
                        <i class="bi bi-graph-up"></i> XAUUSD Price Chart (Real-time)
                    </div>
                    <div class="card-body">
                        <canvas id="price-chart" height="80"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Row 4: Trade History -->
        <div class="row mb-3">
            <div class="col-12">
                <div class="card bg-dark text-light border-secondary">
                    <div class="card-header bg-secondary">
                        <i class="bi bi-clock-history"></i> Recent Trade History
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-dark table-hover table-sm">
                                <thead>
                                    <tr>
                                        <th>Ticket</th>
                                        <th>Type</th>
                                        <th>Entry</th>
                                        <th>Close</th>
                                        <th>Volume</th>
                                        <th>Profit/Loss</th>
                                        <th>Duration</th>
                                        <th>Reason</th>
                                        <th>Time</th>
                                    </tr>
                                </thead>
                                <tbody id="trade-history-body">
                                    <tr>
                                        <td colspan="9" class="text-center" style="color: #aaa;">No trades yet</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Toast Notifications -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="notification-toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <i class="bi bi-bell-fill me-2"></i>
                <strong class="me-auto">Notification</strong>
                <small id="toast-time">now</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
            </div>
            <div class="toast-body" id="toast-body">
                Message here
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom Dashboard JS -->
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>

</body>
</html>
